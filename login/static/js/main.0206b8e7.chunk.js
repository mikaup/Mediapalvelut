(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{15:function(e,t,n){e.exports=n(25)},21:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(12),o=n.n(l),c=(n(21),n(3)),i=n(4),u=n(6),s=n(5),m=n(7),h=n(29),p=n(28),f="http://media.mw.metropolia.fi/wbma/",d=function(e,t){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})};return fetch(f+"login",n).then(function(e){return e.json()})},g=function(e){var t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)};return fetch(f+"users",t).then(function(e){return e.json()})},E=n(27),b="http://media.mw.metropolia.fi/wbma/uploads/",y=function(e){console.log("props",e);var t=e.pic,n=t.thumbnails,a=t.screenshot,l=t.title;return null!==n?r.a.createElement("img",{src:b+n.w160,alt:l}):r.a.createElement("img",{src:b+a,alt:l})},v=function(e){var t=e.pic,n=t.title,a=t.description,l=t.file_id;return r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement(y,{pic:e.pic})),r.a.createElement("td",null,r.a.createElement("h3",null,n),r.a.createElement("p",null,a)),r.a.createElement("td",null,r.a.createElement(E.a,{to:"single/"+l},"View")))},j=function(e){var t=e.picArray.map(function(e,t){return r.a.createElement(v,{key:t,pic:e})});return r.a.createElement("table",null,r.a.createElement("tbody",null,t))},O=function(e){var t=e.picArray;return r.a.createElement(r.a.Fragment,null,r.a.createElement(j,{picArray:t}))},w=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).mediaUrl="http://media.mw.metropolia.fi/wbma/uploads/",n.state={file:"http://placekitten.com/200/200"},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;(function(e){return fetch(f+"media/"+e).then(function(e){return e.json()})})(this.props.match.params.id).then(function(t){console.log(t),e.setState({file:t})})}},{key:"render",value:function(){return r.a.createElement("img",{src:this.mediaUrl+this.state.file.filename,alt:this.state.file.title})}}]),t}(a.Component),k=function(e){return r.a.createElement("nav",null,r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(E.a,{to:"/home"},"Home")),e.checkLogin()&&r.a.createElement(r.a.Fragment,null,r.a.createElement("li",null,r.a.createElement(E.a,{to:"/profile"},"Profile")),r.a.createElement("li",null,r.a.createElement(E.a,{to:"/logout"},"Logout"))),!e.checkLogin()&&r.a.createElement("li",null,r.a.createElement(E.a,{to:"/"},"Login"))))},C=n(13),S=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",email:"",full_name:""},n.handleLoginSubmit=function(e){e.preventDefault(),n.doLogin()},n.handleRegisterSubmit=function(e){e.preventDefault(),g(n.state).then(function(e){console.log(e),n.doLogin()})},n.doLogin=function(){d(n.state.username,n.state.password).then(function(e){console.log(e),n.props.setUser(e.user),localStorage.setItem("token",e.token),n.props.history.push("/home")})},n.handleInputChange=function(e){var t=e.target,a=t.value,r=t.name;console.log(a,r),n.setState(Object(C.a)({},r,a))},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e,t=this;console.log(localStorage.getItem("token")),null!==localStorage.getItem("token")&&(e=localStorage.getItem("token"),fetch(f+"users/user",{headers:{"x-access-token":e}}).then(function(e){return e.json()})).then(function(e){t.props.setUser(e),t.props.history.push("/home")})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Login"),r.a.createElement("form",{onSubmit:this.handleLoginSubmit},r.a.createElement("input",{type:"text",name:"username",placeholder:"username",value:this.state.username,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"password",placeholder:"password",value:this.state.password,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement("button",{type:"submit"},"Login")),r.a.createElement("h1",null,"Register"),r.a.createElement("form",{onSubmit:this.handleRegisterSubmit},r.a.createElement("input",{type:"text",name:"username",placeholder:"username",value:this.state.username,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement("input",{type:"password",name:"password",placeholder:"password",value:this.state.password,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement("input",{type:"email",name:"email",placeholder:"email",value:this.state.email,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement("input",{type:"text",name:"full_name",placeholder:"full name",value:this.state.full_name,onChange:this.handleInputChange}),r.a.createElement("br",null),r.a.createElement("button",{type:"submit"},"Login")))}}]),t}(a.Component),L=function(e){var t=e.user,n=t.username,a=t.email,l=t.full_name;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Profile"),r.a.createElement("p",null,"Username: ",n),r.a.createElement("p",null,"email: ",a),r.a.createElement("p",null,"Full name: ",l))},I=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.setUser(null),localStorage.removeItem("token"),this.props.history.push("/")}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",null,"Logout"))}}]),t}(a.Component),U=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),l=0;l<a;l++)r[l]=arguments[l];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={picArray:[],user:null},n.setUser=function(e){n.setState({user:e})},n.checkLogin=function(){return null!==n.state.user},n}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch(f+"media/").then(function(e){return e.json()}).then(function(e){return console.log(e),Promise.all(e.map(function(e){return fetch(f+"media/"+e.file_id).then(function(e){return e.json()})})).then(function(e){return console.log(e),e})}).then(function(t){console.log(t),e.setState({picArray:t})})}},{key:"render",value:function(){var e=this;return r.a.createElement(h.a,{basename:"/~mikaup/"},r.a.createElement("div",{className:"container"},r.a.createElement(k,{checkLogin:this.checkLogin}),r.a.createElement(p.a,{path:"/home",render:function(t){return r.a.createElement(O,Object.assign({},t,{picArray:e.state.picArray}))}}),r.a.createElement(p.a,{path:"/single/:id",component:w}),r.a.createElement(p.a,{path:"/profile",render:function(t){return r.a.createElement(L,Object.assign({},t,{user:e.state.user}))}}),r.a.createElement(p.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(S,Object.assign({},t,{setUser:e.setUser}))}}),r.a.createElement(p.a,{path:"/logout",render:function(t){return r.a.createElement(I,Object.assign({},t,{setUser:e.setUser}))}})))}}]),t}(a.Component);o.a.render(r.a.createElement(U,null),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.0206b8e7.chunk.js.map